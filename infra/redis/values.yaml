# Redis Helm Chart Values
# Production configuration for raibid-ci job queue

## Redis image
image:
  repository: bitnami/redis
  tag: "7.2.3"
  pullPolicy: IfNotPresent

## Architecture (standalone for MVP)
architecture: standalone

## Authentication
auth:
  enabled: true
  # Password will be generated by raibid-cli
  # existingSecret: raibid-redis-secret

## Persistence
master:
  persistence:
    enabled: true
    size: 8Gi
    storageClass: "local-path"
    accessModes:
      - ReadWriteOnce

  ## Resource limits
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi

  ## Security context
  podSecurityContext:
    enabled: true
    fsGroup: 1001
    runAsUser: 1001

  ## Probes
  livenessProbe:
    enabled: true
    initialDelaySeconds: 20
    periodSeconds: 10
    timeoutSeconds: 5
    successThreshold: 1
    failureThreshold: 5

  readinessProbe:
    enabled: true
    initialDelaySeconds: 20
    periodSeconds: 10
    timeoutSeconds: 5
    successThreshold: 1
    failureThreshold: 5

## Redis configuration
commonConfiguration: |-
  # Persistence
  appendonly yes
  appendfsync everysec

  # Memory management
  maxmemory 450mb
  maxmemory-policy allkeys-lru

  # Stream configuration
  stream-node-max-entries 100

  # Logging
  loglevel notice

## Metrics
metrics:
  enabled: true
  serviceMonitor:
    enabled: false  # Enable with Prometheus Operator

## Network Policy
networkPolicy:
  enabled: false  # Enable for production

## Labels
commonLabels:
  app.kubernetes.io/name: redis
  app.kubernetes.io/component: job-queue
  app.kubernetes.io/part-of: raibid-ci
  app.kubernetes.io/managed-by: helm
